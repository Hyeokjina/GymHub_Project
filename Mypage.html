<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>마이페이지</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        .mypage-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 100;
            overflow-y: auto;
            padding: 2rem 1rem;
        }

        .mypage-container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .mypage-header {
            padding: 2rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .mypage-header h2 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .mypage-header p {
            color: #6b7280;
            margin-top: 0.5rem;
        }

        .mypage-close {
            background: transparent;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6b7280;
            width: 2rem;
            height: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.25rem;
        }

        .mypage-close:hover {
            background: #f3f4f6;
        }

        .tabs-container {
            border-bottom: 1px solid #e5e7eb;
            background: #f9fafb;
        }

        .tabs-list {
            display: flex;
            padding: 0 2rem;
            gap: 1rem;
            overflow-x: auto;
        }

        .tab-button {
            padding: 1rem 1.5rem;
            background: transparent;
            border: none;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            font-weight: 500;
            color: #6b7280;
            white-space: nowrap;
            transition: all 0.2s;
        }

        .tab-button:hover {
            color: #2563eb;
        }

        .tab-button.active {
            color: #2563eb;
            border-bottom-color: #2563eb;
        }

        .tab-content {
            padding: 2rem;
        }

        .tab-pane {
            display: none;
        }

        .tab-pane.active {
            display: block;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1.5rem;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 600;
            color: #2563eb;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: #6b7280;
            font-size: 0.875rem;
        }

        .list-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .list-item {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1.5rem;
        }

        .list-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .list-item-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .list-item-meta {
            font-size: 0.875rem;
            color: #6b7280;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .status-confirmed {
            background: #dcfce7;
            color: #166534;
        }

        .status-cancelled {
            background: #fee2e2;
            color: #991b1b;
        }

        .action-buttons-inline {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .btn {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            cursor: pointer;
            border: 1px solid #d1d5db;
            background: white;
            color: #374151;
            transition: all 0.2s;
        }

        .btn:hover {
            background: #f9fafb;
        }

        .btn-primary {
            background: #2563eb;
            color: white;
            border-color: #2563eb;
        }

        .btn-primary:hover {
            background: #1d4ed8;
        }

        .btn-danger {
            background: #dc2626;
            color: white;
            border-color: #dc2626;
        }

        .btn-danger:hover {
            background: #b91c1c;
        }

        .rating-stars {
            display: flex;
            gap: 0.25rem;
            margin-bottom: 0.5rem;
        }

        .star {
            width: 1.25rem;
            height: 1.25rem;
            cursor: pointer;
        }

        .star-filled {
            fill: #fbbf24;
            color: #fbbf24;
        }

        .star-empty {
            fill: none;
            stroke: #d1d5db;
        }

        .review-content {
            color: #374151;
            line-height: 1.6;
            margin-bottom: 1rem;
        }

        .form-group-inline {
            margin-bottom: 1.5rem;
        }

        .form-label-inline {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: #374151;
        }

        .form-input-inline {
            width: 100%;
            padding: 0.625rem 0.875rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            outline: none;
        }

        .form-input-inline:focus {
            border-color: #2563eb;
            box-shadow: 0 0 0 2px #dbeafe;
        }

        .textarea-inline {
            min-height: 100px;
            resize: vertical;
        }

        .empty-state-inline {
            text-align: center;
            padding: 3rem 1rem;
            color: #6b7280;
        }

        .empty-icon-inline {
            width: 3rem;
            height: 3rem;
            margin: 0 auto 1rem;
            color: #d1d5db;
        }

        .profile-avatar {
            width: 4rem;
            height: 4rem;
            border-radius: 50%;
            background: #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .profile-section {
            border-top: 1px solid #e5e7eb;
            padding-top: 1.5rem;
            margin-top: 1.5rem;
        }

        h3 {
            margin-bottom: 1.5rem;
            font-size: 1.25rem;
        }

        h4 {
            margin-bottom: 1rem;
            font-size: 1rem;
        }

        .edit-form {
            display: none;
        }

        .edit-form.active {
            display: block;
        }

        .review-display.hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .mypage-overlay {
                padding: 0;
            }

            .mypage-container {
                border-radius: 0;
                min-height: 100vh;
            }

            .tabs-list {
                padding: 0 1rem;
            }

            .tab-content {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="mypage-overlay" id="mypageOverlay">
        <div class="mypage-container" onclick="event.stopPropagation()">
            <div class="mypage-header">
                <div>
                    <h2>마이페이지</h2>
                    <p>회원 정보 및 활동 내역을 관리하세요</p>
                </div>
                <button class="mypage-close" onclick="closeMyPage()">×</button>
            </div>

            <div class="tabs-container">
                <div class="tabs-list">
                    <button class="tab-button active" onclick="switchTab('reservations')">예약 내역</button>
                    <button class="tab-button" onclick="switchTab('visits')">방문 기록</button>
                    <button class="tab-button" onclick="switchTab('reviews')">내 리뷰</button>
                    <button class="tab-button" onclick="switchTab('profile')">개인 정보</button>
                </div>
            </div>

            <div class="tab-content">
                <!-- 예약 내역 탭 -->
                <div id="reservations" class="tab-pane active">
                    <h3>예약 내역</h3>
                    <div class="list-container" id="reservationsList"></div>
                </div>

                <!-- 방문 기록 탭 -->
                <div id="visits" class="tab-pane">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="totalVisits">5</div>
                            <div class="stat-label">총 방문 횟수</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="thisMonthVisits">5</div>
                            <div class="stat-label">이번 달 방문</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="totalHours">8</div>
                            <div class="stat-label">총 운동 시간 (시간)</div>
                        </div>
                    </div>

                    <h3>방문 내역</h3>
                    <div class="list-container" id="visitsList"></div>
                </div>

                <!-- 내 리뷰 탭 -->
                <div id="reviews" class="tab-pane">
                    <h3>내 리뷰 (<span id="reviewCount">2</span>)</h3>
                    <div class="list-container" id="reviewsList"></div>
                </div>

                <!-- 개인 정보 탭 -->
                <div id="profile" class="tab-pane">
                    <h3>개인 정보 수정</h3>
                    <form onsubmit="handleProfileSubmit(event)">
                        <div class="form-group-inline">
                            <label class="form-label-inline">프로필 사진</label>
                            <div style="display: flex; align-items: center; gap: 1rem;">
                                <div class="profile-avatar">
                                    <svg width="32" height="32" fill="none" stroke="#9ca3af" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                    </svg>
                                </div>
                                <button type="button" class="btn">사진 변경</button>
                            </div>
                        </div>

                        <div class="form-group-inline">
                            <label class="form-label-inline">이름</label>
                            <input type="text" class="form-input-inline" value="홍길동">
                        </div>

                        <div class="form-group-inline">
                            <label class="form-label-inline">이메일</label>
                            <input type="email" class="form-input-inline" value="hong@example.com">
                        </div>

                        <div class="form-group-inline">
                            <label class="form-label-inline">전화번호</label>
                            <input type="tel" class="form-input-inline" value="010-1234-5678">
                        </div>

                        <div class="form-group-inline">
                            <label class="form-label-inline">생년월일</label>
                            <input type="date" class="form-input-inline" value="1990-01-01">
                        </div>

                        <div class="form-group-inline">
                            <label class="form-label-inline">성별</label>
                            <select class="form-input-inline">
                                <option value="male" selected>남성</option>
                                <option value="female">여성</option>
                                <option value="other">기타</option>
                            </select>
                        </div>

                        <div class="profile-section">
                            <h4>비밀번호 변경</h4>
                            
                            <div class="form-group-inline">
                                <label class="form-label-inline">현재 비밀번호</label>
                                <input type="password" class="form-input-inline" placeholder="현재 비밀번호를 입력하세요">
                            </div>

                            <div class="form-group-inline">
                                <label class="form-label-inline">새 비밀번호</label>
                                <input type="password" class="form-input-inline" placeholder="새 비밀번호를 입력하세요">
                            </div>

                            <div class="form-group-inline">
                                <label class="form-label-inline">새 비밀번호 확인</label>
                                <input type="password" class="form-input-inline" placeholder="새 비밀번호를 다시 입력하세요">
                            </div>
                        </div>

                        <div class="action-buttons-inline" style="margin-top: 2rem;">
                            <button type="submit" class="btn btn-primary">저장하기</button>
                            <button type="button" class="btn" onclick="closeMyPage()">취소</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        const reservations = [
            { id: 1, gymName: "프리미엄 피트니스 센터", date: "2025-10-28", time: "14:00", type: "시설 견학", status: "confirmed" },
            { id: 2, gymName: "스트롱 짐", date: "2025-10-30", time: "10:00", type: "PT 상담", status: "confirmed" },
            { id: 3, gymName: "요가 앤 필라테스 스튜디오", date: "2025-10-25", time: "11:00", type: "체험 수업", status: "cancelled" }
        ];

        const visits = [
            { id: 1, gymName: "프리미엄 피트니스 센터", date: "2025-10-26", duration: "1시간 30분" },
            { id: 2, gymName: "프리미엄 피트니스 센터", date: "2025-10-24", duration: "2시간" },
            { id: 3, gymName: "스트롱 짐", date: "2025-10-23", duration: "1시간 45분" },
            { id: 4, gymName: "프리미엄 피트니스 센터", date: "2025-10-21", duration: "1시간 20분" },
            { id: 5, gymName: "프리미엄 피트니스 센터", date: "2025-10-19", duration: "2시간 10분" }
        ];

        let reviews = [
            { id: 1, gymName: "프리미엄 피트니스 센터", rating: 5, content: "시설이 매우 깨끗하고 직원분들이 친절합니다. 최신 운동 기구들이 잘 갖춰져 있어서 만족스럽습니다.", date: "2025-10-25" },
            { id: 2, gymName: "스트롱 짐", rating: 4, content: "웨이트 트레이닝 하기 좋은 환경입니다. 프리웨이트 존이 넓어서 좋아요.", date: "2025-10-20" }
        ];

        function switchTab(tabName) {
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        function closeMyPage() {
            document.getElementById('mypageOverlay').style.display = 'none';
        }

        function cancelReservation(id) {
            if (confirm('예약을 취소하시겠습니까?')) {
                const index = reservations.findIndex(r => r.id === id);
                if (index !== -1) {
                    reservations[index].status = 'cancelled';
                    renderReservations();
                }
            }
        }

        function deleteReview(id) {
            if (confirm('리뷰를 삭제하시겠습니까?')) {
                const index = reviews.findIndex(r => r.id === id);
                if (index !== -1) {
                    reviews.splice(index, 1);
                    renderReviews();
                }
            }
        }

        function editReview(id) {
            document.getElementById(`review-display-${id}`).classList.add('hidden');
            document.getElementById(`review-edit-${id}`).classList.add('active');
        }

        function cancelEdit(id) {
            document.getElementById(`review-display-${id}`).classList.remove('hidden');
            document.getElementById(`review-edit-${id}`).classList.remove('active');
        }

        function saveReview(id) {
            const content = document.getElementById(`edit-content-${id}`).value;
            const rating = parseInt(document.getElementById(`edit-rating-${id}`).value);
            
            const index = reviews.findIndex(r => r.id === id);
            if (index !== -1) {
                reviews[index].content = content;
                reviews[index].rating = rating;
                renderReviews();
            }
        }

        function setRating(id, rating) {
            document.getElementById(`edit-rating-${id}`).value = rating;
            const stars = document.querySelectorAll(`#review-edit-${id} .star`);
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.classList.add('star-filled');
                    star.classList.remove('star-empty');
                } else {
                    star.classList.remove('star-filled');
                    star.classList.add('star-empty');
                }
            });
        }

        function renderStars(rating, reviewId, editable) {
            let html = '';
            for (let i = 1; i <= 5; i++) {
                const filled = i <= rating ? 'star-filled' : 'star-empty';
                const onClick = editable ? `onclick="setRating(${reviewId}, ${i})"` : '';
                const cursor = editable ? 'cursor: pointer;' : 'cursor: default;';
                html += `
                    <svg class="star ${filled}" viewBox="0 0 20 20" ${onClick} style="${cursor}">
                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                    </svg>
                `;
            }
            return html;
        }

        function renderReservations() {
            const container = document.getElementById('reservationsList');
            container.innerHTML = reservations.map(reservation => `
                <div class="list-item">
                    <div class="list-item-header">
                        <div>
                            <div class="list-item-title">${reservation.gymName}</div>
                            <div class="list-item-meta">📅 ${reservation.date} ${reservation.time} • ${reservation.type}</div>
                        </div>
                        <span class="status-badge ${reservation.status === 'confirmed' ? 'status-confirmed' : 'status-cancelled'}">
                            ${reservation.status === 'confirmed' ? '예약 확정' : '예약 취소'}
                        </span>
                    </div>
                    ${reservation.status === 'confirmed' ? `
                        <div class="action-buttons-inline">
                            <button class="btn btn-danger" onclick="cancelReservation(${reservation.id})">예약 취소</button>
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        function renderVisits() {
            const container = document.getElementById('visitsList');
            container.innerHTML = visits.map(visit => `
                <div class="list-item">
                    <div class="list-item-title">${visit.gymName}</div>
                    <div class="list-item-meta">📅 ${visit.date} • ⏱️ ${visit.duration}</div>
                </div>
            `).join('');
        }

        function renderReviews() {
            const container = document.getElementById('reviewsList');
            document.getElementById('reviewCount').textContent = reviews.length;
            
            if (reviews.length === 0) {
                container.innerHTML = `
                    <div class="empty-state-inline">
                        <svg class="empty-icon-inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
                        </svg>
                        <p>작성한 리뷰가 없습니다</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = reviews.map(review => `
                <div class="list-item">
                    <div id="review-display-${review.id}" class="review-display">
                        <div class="list-item-title">${review.gymName}</div>
                        <div class="rating-stars" style="margin-top: 0.5rem;">
                            ${renderStars(review.rating, review.id, false)}
                        </div>
                        <p class="review-content">${review.content}</p>
                        <div class="list-item-meta" style="margin-bottom: 1rem;">작성일: ${review.date}</div>
                        <div class="action-buttons-inline">
                            <button class="btn" onclick="editReview(${review.id})">수정</button>
                            <button class="btn btn-danger" onclick="deleteReview(${review.id})">삭제</button>
                        </div>
                    </div>
                    
                    <div id="review-edit-${review.id}" class="edit-form">
                        <div class="form-group-inline">
                            <label class="form-label-inline">평점</label>
                            <input type="hidden" id="edit-rating-${review.id}" value="${review.rating}">
                            <div class="rating-stars">
                                ${renderStars(review.rating, review.id, true)}
                            </div>
                        </div>
                        <div class="form-group-inline">
                            <label class="form-label-inline">리뷰 내용</label>
                            <textarea id="edit-content-${review.id}" class="form-input-inline textarea-inline">${review.content}</textarea>
                        </div>
                        <div class="action-buttons-inline">
                            <button class="btn btn-primary" onclick="saveReview(${review.id})">저장</button>
                            <button class="btn" onclick="cancelEdit(${review.id})">취소</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function handleProfileSubmit(event) {
            event.preventDefault();
            alert('개인 정보가 수정되었습니다.');
        }

        document.getElementById('mypageOverlay').addEventListener('click', function(e) {
            if (e.target === this) {
                closeMyPage();
            }
        });

        renderReservations();
        renderVisits();
        renderReviews();
    </script>
</body>
</html>